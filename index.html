<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kitchen Dashboard</title>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }

body {
font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
padding: 20px;
min-height: 100vh;
transition: background 0.8s ease, color 0.8s ease;
}

body.light-theme {
background: linear-gradient(to bottom, #e3f2fd 0%, #f5f7fa 50%, #fafafa 100%);
color: #2c3e50;
}

body.dark-theme {
background: linear-gradient(to bottom, #1a1a2e 0%, #16213e 50%, #0f0f1e 100%);
color: white;
}

/* Setup Page Styles */
.setup-container {
max-width: 800px;
margin: 50px auto;
padding: 40px;
background: white;
border-radius: 20px;
box-shadow: 0 8px 24px rgba(0,0,0,0.15);
color: #2c3e50;
}

.setup-container h1 {
margin-bottom: 10px;
}

.setup-container p {
color: #666;
margin-bottom: 30px;
}

.setup-section {
margin-bottom: 30px;
}

.setup-section h3 {
margin-bottom: 15px;
font-size: 18px;
}

.setup-input {
width: 100%;
padding: 12px;
margin-bottom: 10px;
border: 2px solid #e0e0e0;
border-radius: 8px;
font-size: 14px;
font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}

.setup-input:focus {
outline: none;
border-color: #4da6ff;
}

.setup-button {
width: 100%;
padding: 15px;
background: #4da6ff;
color: white;
border: none;
border-radius: 8px;
font-size: 16px;
font-weight: 600;
cursor: pointer;
}

.setup-button:hover {
background: #3d96ef;
}

/* Dashboard Container */
.container {
max-width: 1800px;
margin: 0 auto;
display: none;
}

.container.active {
display: block;
}

/* Header Section */
.header {
display: grid;
grid-template-columns: 1fr 2fr 1fr;
gap: 20px;
margin-bottom: 24px;
padding-bottom: 24px;
}

.light-theme .header {
border-bottom: 2px solid rgba(0,0,0,0.1);
}

.dark-theme .header {
border-bottom: 2px solid rgba(255,255,255,0.1);
}

.time-section {
text-align: left;
display: flex;
flex-direction: column;
justify-content: center;
}

.time {
font-size: 56px;
font-weight: 300;
margin-bottom: 5px;
}

.date {
font-size: 18px;
opacity: 0.8;
line-height: 1.4;
}

/* Photo Section */
.photo-section {
position: relative;
border-radius: 20px;
overflow: hidden;
box-shadow: 0 8px 24px rgba(0,0,0,0.15);
aspect-ratio: 16/9;
max-height: 450px;
}

.light-theme .photo-section {
background: linear-gradient(135deg, rgba(0,0,0,0.05) 0%, rgba(0,0,0,0.02) 100%);
border: 1px solid rgba(0,0,0,0.08);
}

.dark-theme .photo-section {
background: linear-gradient(135deg, rgba(255,255,255,0.08) 0%, rgba(255,255,255,0.03) 100%);
border: 1px solid rgba(255,255,255,0.1);
}

.photo-frame {
position: relative;
width: 100%;
height: 100%;
}

.photo-image {
position: absolute;
top: 0;
left: 0;
width: 100%;
height: 100%;
object-fit: cover;
opacity: 0;
transition: opacity 1s ease-in-out;
}

.photo-image.active {
opacity: 1;
z-index: 1;
}

.photo-placeholder {
display: flex;
align-items: center;
justify-content: center;
flex-direction: column;
width: 100%;
height: 100%;
font-size: 64px;
opacity: 0.3;
}

/* Weather Card */
.weather-card {
border-radius: 20px;
padding: 24px;
box-shadow: 0 4px 12px rgba(0,0,0,0.1);
transition: all 0.3s ease;
}

.light-theme .weather-card {
background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
border: 1px solid rgba(0,0,0,0.08);
}

.dark-theme .weather-card {
background: linear-gradient(135deg, rgba(255,255,255,0.08) 0%, rgba(255,255,255,0.05) 100%);
border: 1px solid rgba(255,255,255,0.1);
}

.weather-card h2 {
font-size: 18px;
margin-bottom: 16px;
opacity: 0.9;
padding-bottom: 12px;
font-weight: 600;
}

.light-theme .weather-card h2 {
border-bottom: 1px solid rgba(0,0,0,0.1);
}

.dark-theme .weather-card h2 {
border-bottom: 1px solid rgba(255,255,255,0.1);
}

.weather-current {
display: flex;
align-items: center;
gap: 15px;
margin-bottom: 16px;
}

.weather-icon {
font-size: 42px;
}

.temp-section {
flex: 1;
}

.temp {
font-size: 36px;
font-weight: 300;
}

.feels-like {
font-size: 14px;
opacity: 0.7;
margin-top: 4px;
}

.weather-details {
font-size: 13px;
opacity: 0.8;
line-height: 1.8;
}

.sun-times {
display: flex;
gap: 20px;
margin-top: 12px;
padding-top: 12px;
font-size: 13px;
opacity: 0.8;
}

.light-theme .sun-times {
border-top: 1px solid rgba(0,0,0,0.08);
}

.dark-theme .sun-times {
border-top: 1px solid rgba(255,255,255,0.08);
}

.sun-time {
display: flex;
align-items: center;
gap: 6px;
}

.forecast {
display: grid;
grid-template-columns: repeat(4, 1fr);
gap: 10px;
margin-top: 16px;
}

.forecast-day {
padding: 10px;
border-radius: 12px;
text-align: center;
font-size: 12px;
transition: all 0.2s ease;
}

.light-theme .forecast-day {
background: rgba(0,0,0,0.03);
}

.dark-theme .forecast-day {
background: rgba(255,255,255,0.05);
}

.forecast-day:hover {
transform: translateY(-2px);
}

.light-theme .forecast-day:hover {
background: rgba(0,0,0,0.05);
}

.dark-theme .forecast-day:hover {
background: rgba(255,255,255,0.08);
}

.forecast-day .day {
font-weight: 600;
margin-bottom: 6px;
}

.forecast-day .icon {
font-size: 24px;
margin: 6px 0;
}

.forecast-day .temp {
font-size: 16px;
font-weight: 600;
margin: 6px 0;
}

.forecast-day .rain {
opacity: 0.7;
font-size: 11px;
margin-top: 4px;
}

/* Calendar Styles */
.calendar {
border-radius: 20px;
padding: 24px;
margin-bottom: 24px;
box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}

.light-theme .calendar {
background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
border: 1px solid rgba(0,0,0,0.08);
}

.dark-theme .calendar {
background: linear-gradient(135deg, rgba(255,255,255,0.08) 0%, rgba(255,255,255,0.05) 100%);
border: 1px solid rgba(255,255,255,0.1);
}

.calendar h2 {
font-size: 22px;
margin-bottom: 20px;
opacity: 0.9;
padding-bottom: 12px;
font-weight: 600;
}

.light-theme .calendar h2 {
border-bottom: 1px solid rgba(0,0,0,0.1);
}

.dark-theme .calendar h2 {
border-bottom: 1px solid rgba(255,255,255,0.1);
}

.calendar-grid {
display: grid;
grid-template-columns: repeat(7, 1fr);
gap: 6px;
}

.calendar-header {
text-align: center;
font-weight: 600;
font-size: 12px;
padding: 12px 5px;
opacity: 0.7;
text-transform: uppercase;
letter-spacing: 0.5px;
}

.calendar-day {
min-height: 85px;
padding: 8px;
border-radius: 12px;
position: relative;
transition: all 0.2s ease;
}

.light-theme .calendar-day {
background: rgba(0,0,0,0.02);
}

.dark-theme .calendar-day {
background: rgba(255,255,255,0.03);
}

.calendar-day.other-month {
opacity: 0.3;
}

.calendar-day.past {
opacity: 0.4;
}

.light-theme .calendar-day.today {
background: linear-gradient(135deg, rgba(77, 166, 255, 0.2) 0%, rgba(77, 166, 255, 0.1) 100%);
border: 2px solid #4da6ff;
transform: scale(1.02);
}

.dark-theme .calendar-day.today {
background: linear-gradient(135deg, rgba(77, 166, 255, 0.25) 0%, rgba(77, 166, 255, 0.15) 100%);
border: 2px solid #4da6ff;
transform: scale(1.02);
}

.day-number {
font-size: 14px;
font-weight: 600;
margin-bottom: 6px;
}

.day-events {
font-size: 10px;
line-height: 1.5;
}

.day-event {
padding: 3px 5px;
margin-bottom: 3px;
border-radius: 6px;
white-space: nowrap;
overflow: hidden;
text-overflow: ellipsis;
}

.light-theme .day-event {
background: linear-gradient(135deg, rgba(77, 166, 255, 0.25) 0%, rgba(77, 166, 255, 0.15) 100%);
color: #1a5490;
}

.dark-theme .day-event {
background: linear-gradient(135deg, rgba(77, 166, 255, 0.35) 0%, rgba(77, 166, 255, 0.25) 100%);
}

.day-event.more-indicator {
font-weight: 600;
text-align: center;
opacity: 0.8;
}

/* Tasks Section */
.tasks-section {
border-radius: 20px;
padding: 24px;
box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}

.light-theme .tasks-section {
background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
border: 1px solid rgba(0,0,0,0.08);
}

.dark-theme .tasks-section {
background: linear-gradient(135deg, rgba(255,255,255,0.08) 0%, rgba(255,255,255,0.05) 100%);
border: 1px solid rgba(255,255,255,0.1);
}

.tasks-section h2 {
font-size: 22px;
margin-bottom: 20px;
opacity: 0.9;
padding-bottom: 12px;
font-weight: 600;
}

.light-theme .tasks-section h2 {
border-bottom: 1px solid rgba(0,0,0,0.1);
}

.dark-theme .tasks-section h2 {
border-bottom: 1px solid rgba(255,255,255,0.1);
}

.kanban-board {
display: flex;
gap: 20px;
overflow-x: auto;
padding-bottom: 10px;
}

.kanban-column {
min-width: 300px;
flex: 1;
border-radius: 16px;
padding: 16px;
min-height: 200px;
}

.light-theme .kanban-column {
background: rgba(0,0,0,0.02);
}

.dark-theme .kanban-column {
background: rgba(255,255,255,0.03);
}

.kanban-column h3 {
font-size: 16px;
margin-bottom: 16px;
opacity: 0.9;
color: #4da6ff;
font-weight: 600;
}

.task-item {
border-radius: 12px;
padding: 14px;
margin-bottom: 10px;
font-size: 14px;
border-left: 3px solid #4da6ff;
cursor: grab;
user-select: none;
display: flex;
align-items: flex-start;
gap: 12px;
transition: all 0.2s ease;
}

.light-theme .task-item {
background: linear-gradient(135deg, #ffffff 0%, #fafafa 100%);
box-shadow: 0 2px 4px rgba(0,0,0,0.08);
}

.dark-theme .task-item {
background: linear-gradient(135deg, rgba(255,255,255,0.08) 0%, rgba(255,255,255,0.05) 100%);
}

.light-theme .task-item:hover {
box-shadow: 0 4px 12px rgba(0,0,0,0.15);
transform: translateY(-2px);
}

.dark-theme .task-item:hover {
background: linear-gradient(135deg, rgba(255,255,255,0.12) 0%, rgba(255,255,255,0.08) 100%);
transform: translateY(-2px);
}

.task-item:active {
cursor: grabbing;
}

.task-item.dragging {
opacity: 0.5;
}

.task-item.completing {
opacity: 0.3;
text-decoration: line-through;
}

.task-checkbox {
width: 20px;
height: 20px;
border-radius: 6px;
flex-shrink: 0;
margin-top: 1px;
cursor: pointer;
transition: all 0.2s ease;
}

.light-theme .task-checkbox {
border: 2px solid rgba(0,0,0,0.3);
}

.dark-theme .task-checkbox {
border: 2px solid rgba(255,255,255,0.4);
}

.task-checkbox:hover {
border-color: #4da6ff;
background: rgba(77, 166, 255, 0.15);
transform: scale(1.1);
}

.task-text {
flex: 1;
line-height: 1.5;
}

@media (orientation: portrait) {
.header {
grid-template-columns: 1fr;
}
.photo-section {
max-height: 350px;
}
}
</style>
</head>
<body class="light-theme">

<!-- Setup Page -->
<div class="setup-container" id="setupPage">
<h1>üè† Dashboard Setup</h1>
<p>Enter your API credentials once. They'll be saved securely in your browser's localStorage.</p>

<form id="setupForm">
<div class="setup-section">
<h3>‚õÖ Weather Underground</h3>
<input type="text" class="setup-input" id="wu_key" placeholder="API Key" required>
<input type="text" class="setup-input" id="wu_station" placeholder="Station ID (e.g., IJORDA5)" required>
</div>

<div class="setup-section">
<h3>üå¶Ô∏è OpenWeatherMap</h3>
<input type="text" class="setup-input" id="owm_key" placeholder="API Key" required>
<input type="text" class="setup-input" id="owm_lat" placeholder="Latitude (e.g., -33.7306)" required>
<input type="text" class="setup-input" id="owm_lon" placeholder="Longitude (e.g., 150.7478)" required>
</div>

<div class="setup-section">
<h3>üìÖ Google Calendar</h3>
<input type="text" class="setup-input" id="gcal_key" placeholder="API Key" required>
<input type="text" class="setup-input" id="gcal_ids" placeholder="Calendar IDs (comma-separated)" required>
</div>

<div class="setup-section">
<h3>‚úÖ Google Tasks (Optional)</h3>
<p style="font-size: 13px; opacity: 0.7; margin-bottom: 10px;">You'll authorize Tasks with Google after setup</p>
<input type="text" class="setup-input" id="gtask_lists" placeholder="Task Lists (e.g., To Do,Doing)" required>
</div>

<button type="submit" class="setup-button">üíæ Save & Start Dashboard</button>
</form>
</div>

<!-- Dashboard -->
<div class="container" id="dashboard">
<div class="header">
<div class="time-section">
<div class="time" id="time">00:00:00</div>
<div class="date" id="date">Loading...</div>
</div>
<div class="photo-section">
<div class="photo-frame" id="photoFrame">
<div class="photo-placeholder">üì∑</div>
</div>
</div>
<div class="weather-card">
<h2>üå§Ô∏è Weather</h2>
<div class="weather-current">
<div class="weather-icon" id="weatherIcon">‚òÄÔ∏è</div>
<div class="temp-section">
<div class="temp" id="temp">--¬∞C</div>
<div class="feels-like" id="feelsLike">--</div>
</div>
</div>
<div class="weather-details" id="weatherDetails">Loading...</div>
<div class="sun-times">
<div class="sun-time"><span>üåÖ</span><span id="sunrise">--:--</span></div>
<div class="sun-time"><span>üåá</span><span id="sunset">--:--</span></div>
</div>
<div class="forecast" id="forecast"></div>
</div>
</div>

<div class="calendar">
<h2 id="calendarHeader">üìÖ January 2026</h2>
<div id="calendarEvents">
<div>Loading calendar...</div>
</div>
</div>

<div class="tasks-section">
<h2>‚úÖ Tasks</h2>
<div id="tasksAuthPrompt" style="display: none; text-align: center; padding: 40px;">
<p style="font-size: 18px; margin-bottom: 20px;">üìã Authorize Google Tasks to see your task lists</p>
<button id="authTasksBtn" style="padding: 15px 30px; font-size: 16px; background: #4da6ff; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;">üîê Authorize Tasks</button>
</div>
<div class="kanban-board" id="kanbanBoard">
<div class="kanban-column">
<h3>Loading...</h3>
</div>
</div>
</div>
</div>
<script>
// ==================== CONFIG MANAGEMENT ====================
let CONFIG = {};

function loadConfig() {
    const saved = localStorage.getItem('dashboardConfig');
    if (saved) {
        CONFIG = JSON.parse(saved);
        return true;
    }
    return false;
}

function saveConfig(formData) {
    CONFIG = {
        WEATHER_UNDERGROUND: {
            API_KEY: formData.wu_key,
            STATION_ID: formData.wu_station
        },
        OPENWEATHERMAP: {
            API_KEY: formData.owm_key,
            LAT: parseFloat(formData.owm_lat),
            LON: parseFloat(formData.owm_lon)
        },
        GOOGLE_CALENDAR: {
            API_KEY: formData.gcal_key,
            CALENDAR_IDS: formData.gcal_ids.split(',').map(s => s.trim())
        },
        GOOGLE_TASKS: {
            TASK_LISTS: formData.gtask_lists.split(',').map(s => s.trim())
        }
    };
    localStorage.setItem('dashboardConfig', JSON.stringify(CONFIG));
}

// Google Tasks OAuth Config (Web Application)
const GTASK_CLIENT_ID = '188207033000-d4gpeivpi6f89tc2155ua165bk1bcplo.apps.googleusercontent.com';
const GTASK_CLIENT_SECRET = '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';
const GTASK_SCOPES = 'https://www.googleapis.com/auth/tasks';
// Google Tasks OAuth Config OLD (Desktop - don't use):
// const GTASK_CLIENT_ID = '
