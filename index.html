<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kitchen Dashboard</title>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
padding: 20px;
min-height: 100vh;
transition: background 0.8s ease, color 0.8s ease;
}
body.light-theme {
background: linear-gradient(to bottom, #e3f2fd 0%, #f5f7fa 50%, #fafafa 100%);
color: #2c3e50;
}
body.dark-theme {
background: linear-gradient(to bottom, #1a1a2e 0%, #16213e 50%, #0f0f1e 100%);
color: white;
}

/* Setup page styles */
.setup-container {
max-width: 800px;
margin: 50px auto;
padding: 40px;
background: white;
border-radius: 20px;
box-shadow: 0 8px 24px rgba(0,0,0,0.15);
}
.setup-container h1 {
color: #2c3e50;
margin-bottom: 10px;
}
.setup-container p {
color: #666;
margin-bottom: 30px;
}
.setup-section {
margin-bottom: 30px;
}
.setup-section h3 {
color: #2c3e50;
margin-bottom: 15px;
font-size: 18px;
}
.setup-input {
width: 100%;
padding: 12px;
margin-bottom: 10px;
border: 2px solid #e0e0e0;
border-radius: 8px;
font-size: 14px;
}
.setup-input:focus {
outline: none;
border-color: #4da6ff;
}
.setup-button {
width: 100%;
padding: 15px;
background: #4da6ff;
color: white;
border: none;
border-radius: 8px;
font-size: 16px;
font-weight: 600;
cursor: pointer;
}
.setup-button:hover {
background: #3d96ef;
}

/* Dashboard styles */
.container { max-width: 1800px; margin: 0 auto; display: none; }
.container.active { display: block; }
.header {
display: grid;
grid-template-columns: 1fr 2fr 1fr;
gap: 20px;
margin-bottom: 24px;
padding-bottom: 24px;
}
.light-theme .header {
border-bottom: 2px solid rgba(0,0,0,0.1);
}
.dark-theme .header {
border-bottom: 2px solid rgba(255,255,255,0.1);
}
.time-section {
text-align: left;
display: flex;
flex-direction: column;
justify-content: center;
}
.time { font-size: 56px; font-weight: 300; margin-bottom: 5px; }
.date { font-size: 18px; opacity: 0.8; line-height: 1.4; }
.photo-section {
position: relative;
border-radius: 20px;
overflow: hidden;
box-shadow: 0 8px 24px rgba(0,0,0,0.15);
aspect-ratio: 16/9;
max-height: 450px;
}
.light-theme .photo-section {
background: linear-gradient(135deg, rgba(0,0,0,0.05) 0%, rgba(0,0,0,0.02) 100%);
border: 1px solid rgba(0,0,0,0.08);
}
.dark-theme .photo-section {
background: linear-gradient(135deg, rgba(255,255,255,0.08) 0%, rgba(255,255,255,0.03) 100%);
border: 1px solid rgba(255,255,255,0.1);
}
.photo-frame {
position: relative;
width: 100%;
height: 100%;
}
.photo-image {
position: absolute;
top: 0;
left: 0;
width: 100%;
height: 100%;
object-fit: cover;
opacity: 0;
transition: opacity 1s ease-in-out;
}
.photo-image.active {
opacity: 1;
z-index: 1;
}
.photo-placeholder {
display: flex;
align-items: center;
justify-content: center;
flex-direction: column;
width: 100%;
height: 100%;
font-size: 64px;
opacity: 0.3;
}
.weather-card {
border-radius: 20px;
padding: 24px;
box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}
.light-theme .weather-card {
background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
border: 1px solid rgba(0,0,0,0.08);
}
.dark-theme .weather-card {
background: linear-gradient(135deg, rgba(255,255,255,0.08) 0%, rgba(255,255,255,0.05) 100%);
border: 1px solid rgba(255,255,255,0.1);
}
.weather-card h2 {
font-size: 18px;
margin-bottom: 16px;
opacity: 0.9;
padding-bottom: 12px;
font-weight: 600;
}
.light-theme .weather-card h2 {
border-bottom: 1px solid rgba(0,0,0,0.1);
}
.dark-theme .weather-card h2 {
border-bottom: 1px solid rgba(255,255,255,0.1);
}
.weather-current {
display: flex;
align-items: center;
gap: 15px;
margin-bottom: 16px;
}
.weather-icon { font-size: 42px; }
.temp-section { flex: 1; }
.temp { font-size: 36px; font-weight: 300; }
.feels-like { font-size: 14px; opacity: 0.7; margin-top: 4px; }
.weather-details { font-size: 13px; opacity: 0.8; line-height: 1.8; }
.sun-times {
display: flex;
gap: 20px;
margin-top: 12px;
padding-top: 12px;
font-size: 13px;
opacity: 0.8;
}
.light-theme .sun-times {
border-top: 1px solid rgba(0,0,0,0.08);
}
.dark-theme .sun-times {
border-top: 1px solid rgba(255,255,255,0.08);
}
.sun-time { display: flex; align-items: center; gap: 6px; }
.forecast {
display: grid;
grid-template-columns: repeat(4, 1fr);
gap: 10px;
margin-top: 16px;
}
.forecast-day {
padding: 10px;
border-radius: 12px;
text-align: center;
font-size: 12px;
}
.light-theme .forecast-day {
background: rgba(0,0,0,0.03);
}
.dark-theme .forecast-day {
background: rgba(255,255,255,0.05);
}
.forecast-day .day { font-weight: 600; margin-bottom: 6px; }
.forecast-day .icon { font-size: 24px; margin: 6px 0; }
.forecast-day .temp { font-size: 16px; font-weight: 600; margin: 6px 0; }
.forecast-day .rain { opacity: 0.7; font-size: 11px; margin-top: 4px; }

/* More styles... (calendar, tasks, etc) - keeping this shorter for readability */
/* Add rest of CSS from previous version */

</style>
</head>
<body class="light-theme">

<!-- Setup Page -->
<div class="setup-container" id="setupPage">
<h1>üè† Dashboard Setup</h1>
<p>Enter your API credentials. They'll be saved securely in your browser.</p>

<form id="setupForm">
<div class="setup-section">
<h3>Weather Underground</h3>
<input type="text" class="setup-input" id="wu_key" placeholder="API Key" required>
<input type="text" class="setup-input" id="wu_station" placeholder="Station ID (e.g., IJORDA5)" required>
</div>

<div class="setup-section">
<h3>OpenWeatherMap</h3>
<input type="text" class="setup-input" id="owm_key" placeholder="API Key" required>
<input type="text" class="setup-input" id="owm_lat" placeholder="Latitude (e.g., -33.7306)" required>
<input type="text" class="setup-input" id="owm_lon" placeholder="Longitude (e.g., 150.7478)" required>
</div>

<div class="setup-section">
<h3>Google Calendar</h3>
<input type="text" class="setup-input" id="gcal_key" placeholder="API Key" required>
<input type="text" class="setup-input" id="gcal_ids" placeholder="Calendar IDs (comma-separated)" required>
</div>

<div class="setup-section">
<h3>Google Tasks</h3>
<input type="text" class="setup-input" id="gtask_client_id" placeholder="Client ID" required>
<input type="text" class="setup-input" id="gtask_client_secret" placeholder="Client Secret" required>
<input type="text" class="setup-input" id="gtask_access" placeholder="Access Token" required>
<input type="text" class="setup-input" id="gtask_refresh" placeholder="Refresh Token" required>
<input type="text" class="setup-input" id="gtask_lists" placeholder="Task Lists (comma-separated, e.g., To Do,Doing)" required>
</div>

<button type="submit" class="setup-button">Save & Start Dashboard</button>
</form>
</div>

<!-- Dashboard -->
<div class="container" id="dashboard">
<div class="header">
<div class="time-section">
<div class="time" id="time">00:00:00</div>
<div class="date" id="date">Loading...</div>
</div>
<div class="photo-section">
<div class="photo-frame" id="photoFrame">
<div class="photo-placeholder">üì∑</div>
</div>
</div>
<div class="weather-card">
<h2>üå§Ô∏è Weather</h2>
<div class="weather-current">
<div class="weather-icon" id="weatherIcon">‚òÄÔ∏è</div>
<div class="temp-section">
<div class="temp" id="temp">--¬∞C</div>
<div class="feels-like" id="feelsLike">--</div>
</div>
</div>
<div class="weather-details" id="weatherDetails">Loading...</div>
<div class="sun-times">
<div class="sun-time"><span>üåÖ</span><span id="sunrise">--:--</span></div>
<div class="sun-time"><span>üåá</span><span id="sunset">--:--</span></div>
</div>
<div class="forecast" id="forecast"></div>
</div>
</div>
<!-- Add calendar and tasks sections here from previous version -->
</div>

<script>
// Config management
let CONFIG = {};

function loadConfig() {
const saved = localStorage.getItem('dashboardConfig');
if (saved) {
CONFIG = JSON.parse(saved);
return true;
}
return false;
}

function saveConfig(formData) {
CONFIG = {
WEATHER_UNDERGROUND: {
API_KEY: formData.wu_key,
STATION_ID: formData.wu_station
},
OPENWEATHERMAP: {
API_KEY: formData.owm_key,
LAT: parseFloat(formData.owm_lat),
LON: parseFloat(formData.owm_lon)
},
GOOGLE_CALENDAR: {
API_KEY: formData.gcal_key,
CALENDAR_IDS: formData.gcal_ids.split(',').map(s => s.trim())
},
GOOGLE_TASKS: {
CLIENT_ID: formData.gtask_client_id,
CLIENT_SECRET: formData.gtask_client_secret,
ACCESS_TOKEN: formData.gtask_access,
REFRESH_TOKEN: formData.gtask_refresh,
TASK_LISTS: formData.gtask_lists.split(',').map(s => s.trim())
}
};
localStorage.setItem('dashboardConfig', JSON.stringify(CONFIG));
}

// Setup form handler
document.getElementById('setupForm').addEventListener('submit', (e) => {
e.preventDefault();
const formData = {
wu_key: document.getElementById('wu_key').value,
wu_station: document.getElementById('wu_station').value,
owm_key: document.getElementById('owm_key').value,
owm_lat: document.getElementById('owm_lat').value,
owm_lon: document.getElementById('owm_lon').value,
gcal_key: document.getElementById('gcal_key').value,
gcal_ids: document.getElementById('gcal_ids').value,
gtask_client_id: document.getElementById('gtask_client_id').value,
gtask_client_secret: document.getElementById('gtask_client_secret').value,
gtask_access: document.getElementById('gtask_access').value,
gtask_refresh: document.getElementById('gtask_refresh').value,
gtask_lists: document.getElementById('gtask_lists').value
};
saveConfig(formData);
initDashboard();
});

// Photo loading from GitHub
let photoUrls = [];
let currentPhotoIndex = 0;

async function loadGitHubPhotos() {
try {
const pathParts = window.location.pathname.split('/').filter(p => p);
const repoName = pathParts[0] || 'kitchen-dashboard';
const username = 'asm024'; // UPDATE THIS TO YOUR GITHUB USERNAME

const apiUrl = `https://api.github.com/repos/${username}/${repoName}/contents/photos`;
const response = await fetch(apiUrl);
const files = await response.json();

photoUrls = files
.filter(file => /\.(jpg|jpeg|png|gif)$/i.test(file.name))
.map(file => file.download_url);

console.log('Loaded ' + photoUrls.length + ' photos');
if (photoUrls.length > 0) {
showNextPhoto();
setInterval(showNextPhoto, 45000);
}
} catch (error) {
console.error('Photo load error:', error);
}
}

function showNextPhoto() {
if (photoUrls.length === 0) return;

const photoFrame = document.getElementById('photoFrame');
const currentImg = photoFrame.querySelector('.photo-image.active');
const newImg = document.createElement('img');
newImg.className = 'photo-image';
newImg.src = photoUrls[currentPhotoIndex];
newImg.alt = 'Family photo';

newImg.onload = () => {
const placeholder = photoFrame.querySelector('.photo-placeholder');
if (placeholder) placeholder.remove();

photoFrame.appendChild(newImg);
setTimeout(() => newImg.classList.add('active'), 50);
setTimeout(() => { if (currentImg) currentImg.remove(); }, 1500);
};

currentPhotoIndex = (currentPhotoIndex + 1) % photoUrls.length;
}

// Initialize
function initDashboard() {
document.getElementById('setupPage').style.display = 'none';
document.getElementById('dashboard').classList.add('active');
loadGitHubPhotos();
// Add rest of initialization (weather, calendar, tasks, etc.)
}

// Check if config exists
if (loadConfig()) {
initDashboard();
} else {
document.getElementById('setupPage').style.display = 'block';
}
</script>
</body>
</html>
